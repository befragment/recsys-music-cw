# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞.

## üì¶ –ü–∞–∫–µ—Ç—ã

### `bot/`
–û—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Å—å –∫–æ–¥ Telegram-–±–æ—Ç–∞ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –º—É–∑—ã–∫–∏.

#### `bot/core/`
**–Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - –±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- `config.py` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Ç–æ–∫–µ–Ω –±–æ—Ç–∞, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î, –ø—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º)
- `database.py` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SQLAlchemy, —Å–æ–∑–¥–∞–Ω–∏–µ async —Å–µ—Å—Å–∏–π –ë–î
- `container.py` - DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (dependency-injector) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- `middleware.py` - middleware –¥–ª—è –∏–Ω—ä–µ–∫—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ handlers
- `start.py` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

#### `bot/domain/`
**–î–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å** - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ –≤–∏–¥–µ —Å—É—â–Ω–æ—Å—Ç–µ–π:
- `entity/user.py` - –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (telegram_id, –≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª, –ª—é–±–∏–º—ã–π –∂–∞–Ω—Ä)
- `entity/track.py` - –º–æ–¥–µ–ª—å —Ç—Ä–µ–∫–∞ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∞–ª—å–±–æ–º, –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É)
- `entity/interaction.py` - –º–æ–¥–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç—Ä–µ–∫–æ–º (like/dislike/skip)

#### `bot/handler/`
**–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥** - –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- `start.py` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã `/start`, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∞–Ω–∫–µ—Ç—É (–ø–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç, –∂–∞–Ω—Ä)
- `audioplayer.py` - –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä (`/music`, `/liked`, `/disliked`) —Å –∫–Ω–æ–ø–∫–∞–º–∏ like/dislike/skip
- `_contract.py` - –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–ª—è handlers
- `_keyboards.py` - inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –±–æ—Ç–∞
- `utils.py` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `bot/repository/`
**–°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º** - —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ SQLAlchemy:
- `_orm.py` - ORM-–º–æ–¥–µ–ª–∏ SQLAlchemy (UserORM, TrackORM, InteractionORM)
- `user.py` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –ø–æ–ª—É—á–µ–Ω–∏–µ liked/disliked —Ç—Ä–µ–∫–æ–≤
- `track.py` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–µ–∫–∞–º–∏
- `interaction.py` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç—Ä–µ–∫–∞–º–∏

#### `bot/service/`
**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞** - —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
- `_contract.py` - –ø—Ä–æ—Ç–æ–∫–æ–ª—ã (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã) –¥–ª—è DI
- `user.py` - —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `track.py` - —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–∫–∞–º–∏
- `interaction.py` - —Å–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é

#### `bot/recsys/`
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**:
- `model.py` - –º–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

#### `bot/alembic/`
**–ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π –ë–î —á–µ—Ä–µ–∑ Alembic:
- `versions/001_initial_schema.py` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü users, tracks, interactions
- `env.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
- `alembic.ini` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π

#### `bot/scripts/`
**–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã**:
- `populate_tracks.py` - –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î —Ç—Ä–µ–∫–∞–º–∏ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `data/fma_small/`
- `README.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç–æ–≤

#### `bot/main.py`
**–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞** - –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

### `data/`
**–ú—É–∑—ã–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞—Ç–∞—Å–µ—Ç FMA (Free Music Archive):
- `fma_small/` - –∫–æ–ª–ª–µ–∫—Ü–∏—è –∏–∑ ~8000 MP3-—Ñ–∞–π–ª–æ–≤, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º (000-155)
- –¢—Ä–µ–∫–∏ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

---

### `docker-compose.yaml`
**–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
- PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- Telegram –±–æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- Volume –º–∞–ø–ø–∏–Ω–≥ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–æ–≤

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Clean Architecture** —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ —Å–ª–æ–∏:

1. **Domain Layer** (`domain/`) - –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏, –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
2. **Repository Layer** (`repository/`) - –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º (PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy)
3. **Service Layer** (`service/`) - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, orchestration
4. **Handler Layer** (`handler/`) - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Telegram handlers)
5. **Core Layer** (`core/`) - –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
6. **RecSys Layer** (`recsys/`) - –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
- **aiogram 3** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram Bot API
- **SQLAlchemy 2.0** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
- **dependency-injector** - DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- **Alembic** - –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- **FSM (Finite State Machine)** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–∏–∞–ª–æ–≥–æ–≤

–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã (Protocol), —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–ª–∞–±—É—é —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.

